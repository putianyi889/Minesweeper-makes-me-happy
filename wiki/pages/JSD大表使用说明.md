## 文件名：`ArbiterStatsAuto39.9F.xlsm`，下文简称为“大表”。

___
## 开始使用
在Arbiter中进入`游戏`菜单，选择`Save Stats CSV`，即可在Arbiter安装目录中生成`stats_csv.csv`，下文简称为**csv**。

将大表和csv放到同一目录下，打开大表。第一次打开大表需要[启用宏](https://support.microsoft.com/zh-cn/topic/%E5%90%AF%E7%94%A8%E6%88%96%E7%A6%81%E7%94%A8-office-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%AE%8F-12b036fd-d140-4e74-b45e-16fed1a7e5c6)。选择[功能区](https://www.office26.com/excel/excel-ribbon-ui.html)中的`JSD`选项卡，这里就有大表提供的全部功能。其中`计算大表`组最重要，其中的命令会读取csv中的所有数据并计算：`盲扫`仅计算NF数据，`飞标`仅计算FL数据，`双修`计算所有数据。其他功能我们会在后文分别介绍。

___
## 新版本简写
“新版本”指40.1及其之后的版本。为了缩短底下的选项卡长度，进行了十分抽象的简写。
|简写前|简写后|
|:-:|:-:|
|Week|W|
|LSF|Lsf|
|Mon|M|
|Qter|Qua|
|Half|H|
|Year|Y|
|Range|R|
|Num|N|
|Time|T|
|Bvs|B|
|QG|Q|
|Sao|C|
|Corr|O|
|BV|Bv|
|ASB|A|
___
## 参数说明

### 三大参数
三大参数分别是time、bvs、stnb，是我们最关心的参数。许多竞争项目都和这三个参数有关。大表的`Time`、`Bvs`、`QG`三个工作表分别统计了三级别历史上time、bvs、stnb最强的200局的数据。
- time表示一局用时，从0开始计时。
- bvs是最经典的速度参数，`bvs=bv/time`。
- stnb是最平衡的实力参数，`stnb=sqrt(completion)*常数/qg`。
  - `qg=time^1.7/bv`
  - 三级别对应的常数分别为`47.299, 153.73, 435.001`，这些常数是为了让同水平下三级别的stnb大致相等。
  - 对于已完成局来说，`completion=1`，所以`stnb=常数/qg`。

### 固有参数
一张扫雷图的固有参数是直接由雷的分布决定的。大表统计的固有参数有bv、op、is。对于这三个参数的解析可以看[扫雷图的结构以及影响难度的因素分析](https://zhuanlan.zhihu.com/p/27185883)。

大表的`Range`工作表分为上中下三部分，分别统计了三级别下bv、op、is参数对成绩的影响。只统计了当年数据。大表的`Corr`工作表包含了三级别下op、is、op+is的历史最高、最低20局的数据，从中也可以窥见这些参数对于成绩的影响。

### 操作参数
操作参数包括cl、cls、ce、ces、path、mov、sao。大表的`Sao`工作表统计了三级别下cls、ces、mov、sao这四个参数最强25局的数据。大表的`Corr`工作表包含了三级别下cl、ce、path这三个参数最高、最低20局的数据。
- cl表示点击数，具体是左键+右键+双击的点击数。
- cls表示点击速度，`cls=cl/time`。cls越高表示操作频率越高。
- ce表示有效点击数。产生无效点击的原因：
  - 操作失误，点歪。如左键右键点数字、双击数雷。
  - 左键连击时打开了op，反应不及又在op内部连击了几下。
  - 试探双击不成功。
- ces表示有效点击速度，`ces=ce/time`。ces越高表示有意识操作频率越高。
- path表示一局中的总移动距离。Arbiter中的path单位是像素，而大表中path单位是格。换算关系：1格=16像素。
- mov表示移动速度，`mov=path/time`。mov越高表示移动越快。
- sao表示风骚度，`sao=mov*ces`。移动速度越快越容易点歪，对应会导致ces减少。sao是结合了移动速度和ces得到的操作水平。sao越高表示操作越风骚，比如快速精准反复横跳。

### 效率参数
效率参数包括corr、thrp、ioe、iome、coo。大表的`Corr`工作表包含了三级别下corr、thrp、ioe、iome最优秀的20局数据。`Corr`工作表也包含了三级别下coo最高、最低20局数据。
- corr表示点击有效率，`corr=ce/cl`。
- thrp(throughput)表示优化效率（直译吞吐量，又称破空率），`thrp=bv/ce`。
- ioe(index of efficiency)表示总操作效率，`ioe=bv/cl=corr*thrp`。
- iome(index of movement efficiency)表示移动效率，`iome=path/bv`。
- coo(ce on op)表示每个op上消耗的ce，`coo=(ce-bv)/op+1`。

效率参数只受到扫法和固有参数的影响。如果局数增多，由于统计学规律，平均固有参数会大致趋于一个定值，从而平均coo只和扫法有关。从大表中也能看出，同一个人扫法不变的情况下，效率参数的平均值几乎是固定的。不同人的效率参数往往区别非常明显。

### 平均参数
bv、op、is、time、cl、ce、path是基础参数，其它参数必须由它们导出。对基础参数来说，平均参数就是把每一局参数求和然后除以总局数。对于由基础参数导出的参数，平均参数直接由基础参数的平均值导出，例如有两局数据分别为`3*45=135`和`4*55=220`，它们的平均bvs计算方式是先算出`平均bv=177.5`和`平均time=50`，然后得到`平均bvs=177.5/50=3.55`，而不是3和4的平均值3.5。

### 前端成绩
前端成绩指的是前n名成绩。参数后缀添加`n`表示第n名的成绩，而添加`.n`表示前n名成绩之和或均值（具体什么时候表示和什么时候表示均值一眼就能看出来）。例如，time1表示time第一名，也就是time纪录。stnb.5表示前五stnb的均值或和。

`Week`工作表统计了每周的前端成绩，在这里可以清晰地看出n前面加点和不加点的区别。第一个字母b,i,e分别表示初中高级，第二个字母t,b,s分别表示time,bvs,stnb。

`Time, Bvs, QG`三个工作表分别统计了三大参数历史前两百名。

前端stnb和bvs越大越好，前端time越小越好，pp是结合了前端三参数的综合性数据。`pp.n=stnb.n*bvs.n/time.n/常数`，这里`.n`表示平均值，三级别对应的常数分别为`77.9, 4.93, 1`，存储在`Arb!AS27:AS29`。ppp是三级别pp的几何平均。`Week`工作表的最后几列计算了每周的前端pp。

### pb和奖牌相关 <a name="medal"></a>
一个人在某个bv上的最快成绩就是这个人在这个bv的pb，或个人金牌（1st）。类似的，有个人银牌（2nd）等等。大表当前统计到前十的奖牌。一个个人k-th奖牌的价值是10/k，比如铜牌的价值是10/3。大表的`BV`工作表统计了所有个人1st到10th的信息。`ASB`工作表的`AA97:AH166`记录了最近产生的1st到10th。

战力、asb、典型时是综合玩家在所有bv上的表现得到的数据。以下提到的“加权”对应的权重均为bv概率
- 把所有bv上pb的bvs加起来，得到asb。缺失bv的bvs为0。
- 对所有bv上pb的bvs取加权平均，得到战力。类似的还有stnb战力。初级stnb战力不计算2-9bv。
- 如果把“所有bv”改成“一段bv”，则结果叫做分段asb/分段战力/分段stnb战力。标准的分段方式是初级2-9、10-19、20-29、30-54；中级30-39、40-49、50-59、60-69、70-79、80-89、90-99、100-216；高级100-129、130-139、140-149、150-159、160-169、170-179、180-189、190-199、200-209、210-219、220-381。初级2-9没有分段stnb战力。
- 一个分段的加权平均bv，除以分段战力，得到分段典型时。所有标准分段的分段典型时直接相加，得到典型时。
- 如果不取1st而取k-th，则对应结果叫k-th(分段)典型时/asb/战力/stnb战力。
- 把1st到k-th的这些参数直接相加，对应到(分段)典型时k/asbk/战力k/stnb战力k。

已经绕晕了？看大表。

大表的`ASB`工作表的O1:Z84由上到下计算了分段asb10、分段战力10、分段stnb战力10，O335:Z362计算了分段典型时10。

以asb10为例，O2:O24表示bv段，以颜色区分三级别。P2:P24表示对应的分段asb，或者说分段1stasb。以此类推，Q2:Q24表示分段2ndasb，……，Y2:Y24表示分段10thasb。Z2:Z24对这一行求和，表示分段asb10。P25:Y27表示三级别的1st至10thasb，Z25:Z27表示三级别asb10。P28:Y28表示总的1st至10thasb，Z28表示总的asb10。战力、stnb战力、典型时的结构大同小异。

___
## 逐月、逐季度、逐半年、逐年统计 <a name="mon"></a>
|工作表|Mon|Qter|Half|Year|
|:-:|:-:|:-:|:-:|:-:|
|功能|月|季度|半年|年|

这部分工作表是对一段时间内的成绩进行统计，它们的内容除了时间跨度以外没有区别。

按行分，黄色区域为初级，绿色区域为中级，蓝色区域为高级，下方还有三级别合计。每个区域内每行表示一个时间段。默认状态下只会统计最近一段时间，如果希望往前追溯更久远，可以通过`JSD`选项卡中`扩大统计范围`组的功能增加对应的统计范围，点一下加一行。

按列分（忽略隐藏的列）：
- 前面黄/绿/蓝区域标记的是时间段的年/月，如果时间段包含多个月（如`Qter`和`Half`），则用两列月表示起止月。
- 三列该时间段内的基础数据：总局数、平均bv和平均time。
- 四列有色阶的速度数据，为平均bvs，平均ces，平均cls和平均stnb。
- 五列效率数据，为平均op、平均is、平均corr、平均thrp、平均ioe。
- 四列移动数据，为平均path、平均mov、平均iome、平均sao
- 一列天数，表示该时间段任何一级别至少开了一局的天数。开了初级没开高级，也会增加高级天数。后面是一列局/天。
- 十列1st-10th个人奖牌数量，后面是一列奖牌价值。
- 十列前端成绩数量（前20、前40——前200），后面是一列前端成绩价值。
- 三列表现。表现=奖牌价值+前端成绩价值。

___
## 分级别逐月统计、逐年统计
|工作表|BEG|INT|EXP|YA|
|:-:|:-:|:-:|:-:|:-:|
|功能|初级逐月|中级逐月|高级逐月|三级别逐年|

这部分和[逐月、逐季度、逐半年、逐年统计](#mon)的区别是：
- 列的顺序有所不同。
- 在最右末尾多了bvs、stnb、time的前端累计分布。
- 默认统计整个历史，不需要扩大统计范围。不活跃的时间段会留白。

___
## 每年的前端成绩
对应`YT`工作表。统计近7年的三级别前端time、bvs、stnb。
